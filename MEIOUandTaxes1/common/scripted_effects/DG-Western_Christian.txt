
#Setting up base religious aspects
SetCatholicAspects = {
	set_key = { lhs = aspect_01 value = 1 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 1 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 1 } #Baptism and Communion			(2: Adult Baptism, 3: No Baptism)
	set_key = { lhs = aspect_04 value = 1 } #Bible in Latin						(3: Vernacular)
	set_key = { lhs = aspect_05 value = 1 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 1 } #Transubstantiation					(3: Condemned)
	set_key = { lhs = aspect_07 value = 1 } #Indulgences							(3: Condemned)
	set_key = { lhs = aspect_08 value = 1 } #Saint-accepted prayers			(3: Idolatry)
	set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	set_key = { lhs = aspect_11 value = 1 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 2 } #Absenteism							(3: Condemned)
	set_key = { lhs = aspect_17 value = 1 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 1 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 2 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
#	set_key = { lhs = aspect_20 value = 1 }
}

SetWaldensianAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 3 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	set_key = { lhs = aspect_05 value = 1 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 2 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 1 } #Indulgences							(3: Condemned)
	set_key = { lhs = aspect_08 value = 1 } #Saint-accepted prayers			(3: Idolatry)
	set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	set_key = { lhs = aspect_11 value = 1 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 2 } #Absenteism							(3: Condemned)
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 2 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
#	set_key = { lhs = aspect_20 value = 1 }
}

SetLollardCompromiseAspects = {
	set_key = { lhs = aspect_01 value = 1 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 1 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 1 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	set_key = { lhs = aspect_05 value = 1 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 1 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 1 } #Indulgences							(3: Condemned)
	set_key = { lhs = aspect_08 value = 1 } #Saint-accepted prayers			(3: Idolatry)
	set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	set_key = { lhs = aspect_11 value = 1 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 2 } #Absenteism							(3: Condemned)
	set_key = { lhs = aspect_17 value = 2 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 1 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
#	set_key = { lhs = aspect_20 value = 1 }
}

SetLollardAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 3 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 2 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 3 } #Indulgences							(3: Condemned)
	set_key = { lhs = aspect_08 value = 1 } #Saint-accepted prayers			(3: Idolatry)
	set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	set_key = { lhs = aspect_11 value = 3 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 2 } #Absenteism							(3: Condemned)
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 2 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
#	set_key = { lhs = aspect_20 value = 1 }
}

SetHussiteCompromiseAspects = {
	set_key = { lhs = aspect_01 value = 1 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 1 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	set_key = { lhs = aspect_05 value = 2 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 1 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 2 } #Indulgences							(3: Condemned)
	set_key = { lhs = aspect_08 value = 1 } #Saint-accepted prayers			(3: Idolatry)
	set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	set_key = { lhs = aspect_11 value = 1 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 2 } #Absenteism							(3: Condemned)
	set_key = { lhs = aspect_17 value = 2 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 1 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
#	set_key = { lhs = aspect_20 value = 1 }
}

SetHussiteAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 3 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 2 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 3 } #Indulgences							(3: Condemned)
	set_key = { lhs = aspect_08 value = 1 } #Saint-accepted prayers			(3: Idolatry)
	set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	set_key = { lhs = aspect_11 value = 3 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	set_key = { lhs = aspect_14 value = 1 } #Simony Condemned					(3: Authorised)
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 3 } #Absenteism							(3: Condemned)
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 2 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
#	set_key = { lhs = aspect_20 value = 1 }
}

SetProtestantCompromiseAspects = {
	set_key = { lhs = aspect_01 value = 2 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 1 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 1 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 2 } #Indulgences							(3: Condemned)
	set_key = { lhs = aspect_08 value = 1 } #Saint-accepted prayers			(3: Idolatry)
	set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	set_key = { lhs = aspect_11 value = 1 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 3 } #Absenteism							(3: Condemned)
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 2 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
#	set_key = { lhs = aspect_20 value = 1 }
}

SetProtestantAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 3 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 2 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 3 } #Indulgences							(3: Condemned)
	set_key = { lhs = aspect_08 value = 3 } #Saint-accepted prayers			(3: Idolatry)
	set_key = { lhs = aspect_09 value = 3 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	set_key = { lhs = aspect_10 value = 3 } #Divorce Forbidden					(3: Legalised)
	set_key = { lhs = aspect_11 value = 3 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 3 } #Non-Regulated Parish Registers	(3: Regulated)
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	set_key = { lhs = aspect_14 value = 1 } #Simony Condemned					(3: Authorised)
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 3 } #Absenteism							(3: Condemned)
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 3 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
#	set_key = { lhs = aspect_20 value = 1 }
}

SetReformedCompromiseAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 1 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 1 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 3 } #Indulgences							(3: Condemned)
	set_key = { lhs = aspect_08 value = 1 } #Saint-accepted prayers			(3: Idolatry)
	set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	set_key = { lhs = aspect_10 value = 3 } #Divorce Forbidden					(3: Legalised)
	set_key = { lhs = aspect_11 value = 3 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
	set_key = { lhs = aspect_15 value = 2 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 3 } #Absenteism							(3: Condemned)
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 2 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
#	set_key = { lhs = aspect_20 value = 1 }
}

SetReformedAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 2 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 3 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 3 } #Indulgences							(3: Condemned)
	set_key = { lhs = aspect_08 value = 3 } #Saint-accepted prayers			(3: Idolatry)
	set_key = { lhs = aspect_09 value = 3 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	set_key = { lhs = aspect_10 value = 3 } #Divorce Forbidden					(3: Legalised)
	set_key = { lhs = aspect_11 value = 3 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 3 } #Non-Regulated Parish Registers	(3: Regulated)
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	set_key = { lhs = aspect_14 value = 1 } #Simony Condemned					(3: Authorised)
	set_key = { lhs = aspect_15 value = 3 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 3 } #Absenteism							(3: Condemned)
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 3 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
#	set_key = { lhs = aspect_20 value = 1 }
}

#Changing religious aspects
ReformingAspect = {
	change_key = { lhs = aspect_$typea$ value = $valuea$ }
	if = {
		limit = {
			NOT = { check_key = { lhs = aspect_$typea$ value = 1 } }
		}
		set_key = { lhs = aspect_$typea$ value = 1 }
	}
	else_if = {
		limit = {
			check_key = { lhs = aspect_$typea$ value = 4 }
		}
		set_key = { lhs = aspect_$typea$ value = 3 }
	}
}

#Effect to remove a cardinal
RemoveCardinal = {
	remove_cardinal = yes
	hidden_effect = {
		PAP = { change_key = { lhs = MN_Curia_Cur value = -1 } }
		clr_province_flag = cardinal_1_year
		clr_province_flag = cardinal_5_years
		clr_province_flag = cardinal_10_years
		clr_province_flag = cardinal_15_years
		clr_province_flag = cardinal_20_years
		#Triggers potential replacing of cardinal in same country
		if = {
			limit = { owner = { has_country_flag = papacy_notification } }
			province_event = { id = DG_Papacy.004 }
		}
	}
}

#Effect to add a cardinal with his lifespan
AddCardinal = {
	if = {
		limit = { has_cardinal = no }
		add_cardinal = yes
		PAP = { change_key = { lhs = MN_Curia_Cur value = 1 } }
	}
	hidden_effect = {
		owner = { add_papal_influence = 5 }
		random_list = {
			1 = { set_province_flag = cardinal_1_year }
			9 = { set_province_flag = cardinal_5_years }
			65 = { set_province_flag = cardinal_10_years }
			20 = { set_province_flag = cardinal_15_years }
			5 = { set_province_flag = cardinal_20_years }
		}
		if = {
			limit = { owner = { has_country_flag = papacy_notification } }
			province_event = { id = DG_Papacy.005 }
		}
	}
}

#Province score for getting a Cardinal
CardinalChanceP = {
	#Base cardinal value is based on urban population
	#Effect of religious infrastructure
	if = {
		limit = { is_key_equal = { lhs = MN_S0 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S0TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S0INF }
	}
	else_if = {
		limit = { is_key_equal = { lhs = MN_S1 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S1TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S1INF }
	}
	else_if = {
		limit = { is_key_equal = { lhs = MN_S2 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S2TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S2INF }
	}
	else_if = {
		limit = { is_key_equal = { lhs = MN_S3 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S3TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S3INF }
	}
	else_if = {
		limit = { is_key_equal = { lhs = MN_S4 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S4TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S4INF }
	}
	else_if = {
		limit = { is_key_equal = { lhs = MN_S4 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S5TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S5INF }
	}
	else = {
		set_key = { lhs = MN_Cardinal value = 0 }
	}
	#Bonus if province has an archbisopric
	if = {
		limit = {
			OR = {
				has_province_flag = MN_Archbishopric
				has_province_flag = MN_Patriarchate
			}
		}
		change_key = { lhs = MN_Cardinal value = 1.5 }
	}
	#Effect of local clergy power
	if = {
		limit = {
			check_key = { lhs = Prov_CLPow value = 75 }
		}
		multiply_key = { lhs = MN_Cardinal value = 1.2 }
	}
	else_if = {
		limit = {
			check_key = { lhs = Prov_CLPow value = 50 }
		}
		multiply_key = { lhs = MN_Cardinal value = 1.1 }
	}
	else_if = {
		limit = {
			check_key = { lhs = Prov_CLPow value = 25 }
		}
		multiply_key = { lhs = MN_Cardinal value = 1.0 }
	}
	else = {
		multiply_key = { lhs = MN_Cardinal value = 0.8 }
	}
	#Miscellaneous factors
	if = {
		limit = { NOT = { continent = europe } }
		multiply_key = { lhs = MN_Cardinal value = 0.1 }
	}
	if = {
		limit = { has_owner_culture = yes }
		multiply_key = { lhs = MN_Cardinal value = 1.2 }
	}
	if = {
		limit = { culture_group = owner }
		multiply_key = { lhs = MN_Cardinal value = 1.2 }
	}
	if = {
		limit = { is_capital = yes }
		multiply_key = { lhs = MN_Cardinal value = 1.5 }
	}
}

#Cardinal score for countries
CardinalChanceC = { 
	if = {
		#Only Catholic non-excommunicated nations can get cardinals
		limit = {
			OR = {
				religion = catholic
				religion = holyleague
			}
			is_excommunicated = no
			NOT = { tag = PAP }
			NOT = { tag = AVI }
		}
		#Bonus for provinces in same superregion 
		if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = france_superregion }
				PAP = { capital_scope = { superregion = france_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = italy_superregion }
				PAP = { capital_scope = { superregion = italy_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = iberia_superregion }
				PAP = { capital_scope = { superregion = iberia_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = germany_superregion }
				PAP = { capital_scope = { superregion = germany_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = british_isles_superregion }
				PAP = { capital_scope = { superregion = british_isles_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = scandinavian_superregion }
				PAP = { capital_scope = { superregion = scandinavian_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = greater_austrian_circle_superregion }
				PAP = { capital_scope = { superregion = greater_austrian_circle_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = balkan_superregion }
				PAP = { capital_scope = { superregion = balkan_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = commonwealth_superregion }
				PAP = { capital_scope = { superregion = commonwealth_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = greater_russia_superregion }
				PAP = { capital_scope = { superregion = greater_russia_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else = {
			set_key = { lhs = MN_Cardinal value = 1 }
		}
		multiply_key = { lhs = MN_Cardinal value = 30 }
		#The more clergy estate power, the higher the chance of a cardinal
		if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 50 } } # Clergy loyalty
			multiply_key = { lhs = MN_Cardinal value = 1.5 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 25 } }
			multiply_key = { lhs = MN_Cardinal value = 1.2 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 10 } }
			multiply_key = { lhs = MN_Cardinal value = 1.0 }
		}
		else = {
			multiply_key = { lhs = MN_Cardinal value = 0.8 }
		}
		#The more clergy estate influence, the higher the chance of a cardinal
		if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 50 } } # Clergy loyalty
			multiply_key = { lhs = MN_Cardinal value = 1.5 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 25 } }
			multiply_key = { lhs = MN_Cardinal value = 1.2 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 10 } }
			multiply_key = { lhs = MN_Cardinal value = 1.0 }
		}
		else = {
			multiply_key = { lhs = MN_Cardinal value = 0.8 }
		}
		#Piety impacts chance of getting a cardinal
		if = {
			limit = { piety = 0.60 }
			multiply_key = { lhs = MN_Cardinal value = 1.2 }
		}
		else_if = {
			limit = { piety = 0.20 }
			multiply_key = { lhs = MN_Cardinal value = 1.1 }
		}
		else_if = {
			limit = { piety = -0.20 }
			multiply_key = { lhs = MN_Cardinal value = 1.0 }
		}
		else_if = {
			limit = { piety = -0.60 }
			multiply_key = { lhs = MN_Cardinal value = 0.9 }
		}
		else = {
			multiply_key = { lhs = MN_Cardinal value = 0.8 }
		}
		#How the Pope like you impacts chance of getting a cardinal
		if = {
			limit = { PAP = { has_opinion = { who = ROOT value = 150 } } }
			multiply_key = { lhs = MN_Cardinal value = 1.4 }
		}
		else_if = {
			limit = { PAP = { has_opinion = { who = ROOT value = 50 } } }
			multiply_key = { lhs = MN_Cardinal value = 1.2 }
		}
		else_if = {
			limit = { PAP = { has_opinion = { who = ROOT value = -50 } } }
			multiply_key = { lhs = MN_Cardinal value = 1.0 }
		}
		else_if = {
			limit = { PAP = { has_opinion = { who = ROOT value = -150 } } }
			multiply_key = { lhs = MN_Cardinal value = 0.8 }
		}
		else = {
			multiply_key = { lhs = MN_Cardinal value = 0.6 }
		}
	}
}

#Papal Corruption Check
papal_corruption_se = {
	#Based on actual country corrupption
	export_to_key = {
		lhs = MN_Pap_Corruption
		value = corruption
	}
	#Down from 0 to 10
	multiply_key = { lhs = MN_Pap_Corruption value = 0.10 }
	#Some randomisation
	random_list = {
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 0.75 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 0.80 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 0.85 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 0.90 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 0.95 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.00 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.05 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.10 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.15 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.20 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.25 } }
	}
	#Indulgences accepted
	if = {
		limit = { is_key_equal = { lhs = aspect_07 value = 1 } }
		change_key = { lhs = MN_Pap_Corruption value = 1 }
	}
	#Indulgences condemned
	else_if = {
		limit = { is_key_equal = { lhs = aspect_07 value = 3 } }
		change_key = { lhs = MN_Pap_Corruption value = -1 }
	}
	#Simony accepted
	if = {
		limit = { is_key_equal = { lhs = aspect_14 value = 3 } }
		change_key = { lhs = MN_Pap_Corruption value = 1 }
	}
	#Simony condemned
	else_if = {
		limit = { is_key_equal = { lhs = aspect_14 value = 1 } }
		change_key = { lhs = MN_Pap_Corruption value = -1 }
	}
	#Wealthy Clergy
	if = {
		limit = { is_key_equal = { lhs = aspect_17 value = 4 } }
		change_key = { lhs = MN_Pap_Corruption value = 1 }
	}
	#Clergy Poverty
	else_if = {
		limit = { is_key_equal = { lhs = aspect_17 value = 3 } }
		change_key = { lhs = MN_Pap_Corruption value = -1 }
	}
	#Graft during election
	if = {
		limit = { OR = { has_country_flag = accepted_graft babylonian_captivity = yes } }
		change_key = { lhs = MN_Pap_Corruption value = 2 }
	}
	else_if = {
		limit = { has_country_flag = refused_graft }
		change_key = { lhs = MN_Pap_Corruption value = -2 }
	}
	#Size of the Curia
	if = {
		limit = { has_country_flag = restricted_curia }
		change_key = { lhs = MN_Pap_Corruption value = 1 }
	}
	else_if = {
		limit = { has_country_flag = enlarged_curia }
		change_key = { lhs = MN_Pap_Corruption value = 0 }
	}
	else_if = {
		limit = { has_country_flag = extended_curia }
		change_key = { lhs = MN_Pap_Corruption value = -1 }
	}
	else_if = {
		limit = { has_country_flag = unrestricted_curia }
		change_key = { lhs = MN_Pap_Corruption value = -2 }
	}
}

#Deadlocked Conclave
conclave_deadlock = {
	random_list = {
		20 = { country_event = { id = DG_Papacy.113 days =  120 } }
		20 = { country_event = { id = DG_Papacy.113 days =  180 } }
		20 = { country_event = { id = DG_Papacy.113 days =  240 } }
		19 = { country_event = { id = DG_Papacy.113 days =  300 } }
		15 = { country_event = { id = DG_Papacy.113 days =  360 } }
		 5 = { country_event = { id = DG_Papacy.113 days =  730 } }
		 1 = { country_event = { id = DG_Papacy.113 days = 1825 } }
	}
}

#Calculate Papal Authority
Calc_Pap_Auth = {
	PAP = {
		set_key = { lhs = DG_Tmp1 value = 0 }
		set_key = { lhs = DG_Tmp2 value = 0 }
		set_key = { lhs = DG_Tmp3 value = 0 }
		set_key = { lhs = DG_Tmp4 value = 0 }
		set_key = { lhs = DG_Tmp5 value = 0 }
		set_key = { lhs = MN_Pap_Auth value = 0 }
	}
	AVI = {
		set_key = { lhs = DG_Tmp1 value = 0 }
		set_key = { lhs = DG_Tmp2 value = 0 }
		set_key = { lhs = DG_Tmp3 value = 0 }
		set_key = { lhs = DG_Tmp4 value = 0 }
		set_key = { lhs = DG_Tmp5 value = 0 }
		set_key = { lhs = MN_Pap_Auth value = 0 }
	}
	every_known_country = {
		limit = { western_christian = yes }
		PAP = { change_key = { lhs = DG_Tmp1 value = 1 } }
		AVI = { change_key = { lhs = DG_Tmp1 value = 1 } }
		if = {
			limit = { religion = catholic }
			PAP = { change_key = { lhs = DG_Tmp2 value = 1 } }
		}
		else_if = {
			limit = { religion = holyleague }
			AVI = { change_key = { lhs = DG_Tmp2 value = 1 } }
		}
		every_owned_province = {
			limit = { western_christian = yes }
			PAP = { change_key = { lhs = DG_Tmp3 value = 0.1 } }
			AVI = { change_key = { lhs = DG_Tmp3 value = 0.1 } }
			if = {
				limit = { owned_by = PAP }
				PAP = { change_key = { lhs = DG_Tmp4 value = 0.1 } }
			}
			else_if = {
				limit = { owned_by = AVI }
				AVI = { change_key = { lhs = DG_Tmp4 value = 0.1 } }
			}
			if = {
				limit = { religion = catholic }
				PAP = { change_key = { lhs = DG_Tmp5 value = 0.1 } }
				trigger_switch = {
					on_trigger = has_province_flag
					MN_Archbishopric  = {
						PAP = { change_key = { lhs = DG_Tmp5 value = 0.05 } }
					}
					MN_Patriarchate = {
						PAP = { change_key = { lhs = DG_Tmp5 value = 0.01 } }
					}
				}
			}
			else_if = {
				limit = { religion = holyleague }
				AVI = { change_key = { lhs = DG_Tmp5 value = 0.1 } }
				trigger_switch = {
					on_trigger = has_province_flag
					MN_Archbishopric  = {
						AVI = { change_key = { lhs = DG_Tmp5 value = 0.05 } }
					}
					MN_Patriarchate = {
						AVI = { change_key = { lhs = DG_Tmp5 value = 0.01 } }
					}
				}
			}
		}
	}
	PAP = {
		if = {
			limit = { NOT = { is_key_equal = { lhs = DG_Tmp1 value = 0 } } }
			divide_key = { lhs = DG_Tmp2 which = DG_Tmp1 }
			multiply_key = { lhs = DG_Tmp2 value = 200 }
			set_key = { lhs = MN_Pap_Auth which = DG_Tmp2 }
		}
		if = {
			limit = { NOT = { is_key_equal = { lhs = DG_Tmp3 value = 0 } } }
			divide_key = { lhs = DG_Tmp5 which = DG_Tmp3 }
		}
		multiply_key = { lhs = DG_Tmp5 value = 200 }
		change_key = { lhs = MN_Pap_Auth which = DG_Tmp5 }
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_04 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_05 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_13 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_18 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = waldensian }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = lollard }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = hussite }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = protestant }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = reformed }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = fraticelli }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { babylonian_captivity = yes }
			multiply_key = { lhs = MN_Pap_Auth value = 0.50 }
		}
		else_if = {
			limit = { NOT = { has_global_flag = living_rome_pope } }
			multiply_key = { lhs = MN_Pap_Auth value = 0.50 }
		}
		else_if = {
			limit = { has_global_flag = living_rome_pope is_papal_controller = yes }
			change_key = { lhs = MN_Pap_Auth value = 100 }
		}
		if = {
			limit = { has_country_flag = pious_pope }
			multiply_key = { lhs = MN_Pap_Auth value = 1.10 }
		}
		else_if = {
			limit = { has_country_flag = corrupt_pope }
			multiply_key = { lhs = MN_Pap_Auth value = 0.90 }
		}
		if = {
			limit = { NOT = { check_key = { lhs = MN_Pap_Auth value = 1 } } }
			set_key = { lhs = MN_Pap_Auth value = 1 }
		}
		set_key = { lhs = DG_Tmp1 value = 0 }
		set_key = { lhs = DG_Tmp2 value = 0 }
		set_key = { lhs = DG_Tmp3 value = 0 }
		set_key = { lhs = DG_Tmp4 value = 0 }
		set_key = { lhs = DG_Tmp5 value = 0 }
	}
	AVI = {
		if = {
			limit = { NOT = { is_key_equal = { lhs = DG_Tmp1 value = 0 } } }
			divide_key = { lhs = DG_Tmp2 which = DG_Tmp1 }
			multiply_key = { lhs = DG_Tmp2 value = 200 }
			set_key = { lhs = MN_Pap_Auth which = DG_Tmp2 }
		}
		if = {
			limit = { NOT = { is_key_equal = { lhs = DG_Tmp3 value = 0 } } }
			divide_key = { lhs = DG_Tmp5 which = DG_Tmp3 }
		}
		multiply_key = { lhs = DG_Tmp5 value = 200 }
		change_key = { lhs = MN_Pap_Auth which = DG_Tmp5 }
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_04 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_05 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_13 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_18 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = waldensian }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = lollard }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = hussite }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = protestant }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = reformed }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = fraticelli }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { babylonian_captivity = yes }
			multiply_key = { lhs = MN_Pap_Auth value = 0.75 }
		}
		else_if = {
			limit = { NOT = { has_global_flag = living_avignon_pope } }
			multiply_key = { lhs = MN_Pap_Auth value = 0.50 }
		}
		else_if = {
			limit = { has_global_flag = living_avignon_pope is_papal_controller = yes }
			change_key = { lhs = MN_Pap_Auth value = 100 }
		}
		if = {
			limit = { has_country_flag = pious_pope }
			multiply_key = { lhs = MN_Pap_Auth value = 1.10 }
		}
		else_if = {
			limit = { has_country_flag = corrupt_pope }
			multiply_key = { lhs = MN_Pap_Auth value = 0.90 }
		}
		if = {
			limit = { NOT = { check_key = { lhs = MN_Pap_Auth value = 0 } } }
			set_key = { lhs = MN_Pap_Auth value = 0 }
		}
		set_key = { lhs = DG_Tmp1 value = 0 }
		set_key = { lhs = DG_Tmp2 value = 0 }
		set_key = { lhs = DG_Tmp3 value = 0 }
		set_key = { lhs = DG_Tmp4 value = 0 }
		set_key = { lhs = DG_Tmp5 value = 0 }
	}
}

#Calculates how likely a nation is to have a Pope of his culture
DG_Papabile = {
	if = {
		#Only Catholic non-excommunicated nations can get cardinals
		limit = {
			OR = {
				religion = catholic
				religion = holyleague
			}
			num_of_cities = 5
			is_excommunicated = no
			NOT = { tag = PAP }
			NOT = { tag = AVI }
		}
		if = {
			limit = { num_of_cardinals = 1 }
			export_to_key = {
				lhs = DG_Papability
				value = trigger_value:num_of_cardinals
			}
			#Piety impacts chance of getting a cardinal
			if = {
				limit = { piety = 0.60 }
				change_key = { lhs = DG_Papability value = 2 }
			}
			else_if = {
				limit = { piety = 0.20 }
				change_key = { lhs = DG_Papability value = 1 }
			}
			else_if = {
				limit = { piety = -0.20 }
				change_key = { lhs = DG_Papability value = 0 }
			}
			else_if = {
				limit = { piety = -0.60 }
				change_key = { lhs = DG_Papability value = -1 }
			}
			else = {
				change_key = { lhs = DG_Papability value = -2 }
			}
			#How the Pope like you impacts chance of getting a cardinal
			if = {
				limit = { PAP = { has_opinion = { who = ROOT value = 150 } } }
				change_key = { lhs = DG_Papability value = 2 }
			}
			else_if = {
				limit = { PAP = { has_opinion = { who = ROOT value = 50 } } }
				change_key = { lhs = DG_Papability value = 1 }
			}
			else_if = {
				limit = { PAP = { has_opinion = { who = ROOT value = -50 } } }
				change_key = { lhs = DG_Papability value = 0 }
			}
			else_if = {
				limit = { PAP = { has_opinion = { who = ROOT value = -150 } } }
				change_key = { lhs = DG_Papability value = -1 }
			}
			else = {
				change_key = { lhs = DG_Papability value = -2 }
			}
			export_to_key = {
				lhs = DG_Tmp1
				value = prestige
			}
			divide_key = { lhs = DG_Tmp1 value = 10 }
			change_key = { lhs = DG_Papability which = DG_Tmp1 }
		}
		if = {
			limit = { has_country_flag = pap }
			multiply_key = { lhs = DG_Papability value = 1.5 }
		}
		if = {
			limit = { capital_scope = { superregion = france_superregion } }
			change_key = { lhs = DG_Papability value = 2.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = france_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = italy_superregion } }
			change_key = { lhs = DG_Papability value = 3.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = italy_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = iberia_superregion } }
			change_key = { lhs = DG_Papability value = 1.5 }
			if = {
				limit = { PAP = { capital_scope = { superregion = iberia_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = germany_superregion } }
			change_key = { lhs = DG_Papability value = 1.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = germany_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = british_isles_superregion } }
			change_key = { lhs = DG_Papability value = -0.5 }
			if = {
				limit = { PAP = { capital_scope = { superregion = british_isles_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = scandinavian_superregion } }
			change_key = { lhs = DG_Papability value = -1.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = scandinavian_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = greater_austrian_circle_superregion } }
			change_key = { lhs = DG_Papability value = 1.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = greater_austrian_circle_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = balkan_superregion } }
			change_key = { lhs = DG_Papability value = -1.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = balkan_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = commonwealth_superregion } }
			change_key = { lhs = DG_Papability value = -1.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = commonwealth_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = greater_russia_superregion } }
			change_key = { lhs = DG_Papability value = -2.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = greater_russia_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		#The more clergy estate power, the higher the chance of a cardinal
		if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 50 } } # Clergy loyalty
			multiply_key = { lhs = DG_Papability value = 1.5 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 25 } }
			multiply_key = { lhs = DG_Papability value = 1.2 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 10 } }
			multiply_key = { lhs = DG_Papability value = 1.0 }
		}
		else = {
			multiply_key = { lhs = DG_Papability value = 0.8 }
		}
		#The more clergy estate influence, the higher the chance of a cardinal
		if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 50 } } # Clergy loyalty
			multiply_key = { lhs = DG_Papability value = 1.5 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 25 } }
			multiply_key = { lhs = DG_Papability value = 1.2 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 10 } }
			multiply_key = { lhs = DG_Papability value = 1.0 }
		}
		else = {
			multiply_key = { lhs = DG_Papability value = 0.8 }
		}
	}
}

add_curia_treasury_small_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = 25
	}
}

add_curia_treasury_medium_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = 50
	}
}

add_curia_treasury_big_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = 100
	}
}

add_curia_treasury_huge_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = 1000
	}
}

reduce_curia_treasury_medium_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = -50
	}
}

reduce_curia_treasury_big_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = -100
	}
}

reduce_curia_treasury_huge_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = -1000
	}
}

support_rebels_effect = {
	if = {
		limit = { hre_heretic_religion = ROOT }
		if = {
			limit = { piety = 0.60 }
			add_prestige = 8
			add_legitimacy = 4
		}
		else_if = {
			limit = { piety = 0.20 }
			add_prestige = 6
			add_legitimacy = 3
		}
		else_if = {
			limit = { piety = -0.20 }
			add_prestige = 4
			add_legitimacy = 2
		}
		else_if = {
			limit = { piety = -0.60 }
			add_prestige = 2
			add_legitimacy = 1
		}
	}
	add_yearly_manpower = -0.10
	if = {
		limit = { monthly_income = 250 }
		add_treasury = -500
	}
	else_if = {
		limit = { monthly_income = 2 }
		add_years_of_income = -0.16
	}
	else = {
		add_treasury = -4
	}
	every_known_country = {
		limit = { in_league = protestant }
		if = {
			limit = { ROOT = { piety = 0.60 } }
			reverse_add_opinion = { who = ROOT modifier = holy_league_fanatical }
		}
		else_if = {
			limit = { ROOT = { piety = 0.20 } }
			reverse_add_opinion = { who = ROOT modifier = holy_league_pious }
		}
		else_if = {
			limit = { ROOT = { piety = -0.20 } }
			reverse_add_opinion = { who = ROOT modifier = holy_league_observant }
		}
		else_if = {
			limit = { ROOT = { piety = -0.60 } }
			reverse_add_opinion = { who = ROOT modifier = holy_league_decadent }
		}
	}
	hidden_effect = {
		if = {
			limit = { max_manpower = 128 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 12.8 }
			}
		}
		else_if = {
			limit = { max_manpower = 64 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 6.4 }
			}
		}
		else_if = {
			limit = { max_manpower = 32 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 3.2 }
			}
		}
		else_if = {
			limit = { max_manpower = 16 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 1.6 }
			}
		}
		else_if = {
			limit = { max_manpower = 8 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 0.8 }
			}
		}
		else_if = {
			limit = { max_manpower = 4 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 0.4 }
			}
		}
		else_if = {
			limit = { max_manpower = 2 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 0.2 }
			}
		}
		else = {
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 0.1 }
			}
		}
		if = {
			limit = { NOT = { monthly_income = 5 } }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 4 }
			}
		}
		if = {
			limit = {
				monthly_income = 5
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 10
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 15
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 20
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 30
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 40
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 50
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 60
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 80
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 100
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 120
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 140
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 160
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 180
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 200
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 225
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 50 }
			}
		}
		if = {
			limit = {
				monthly_income = 250
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 50 }
			}
		}
	}
	random_country = {
		limit = { is_league_leader = yes is_emperor = no }
		country_event = { id = DG_Catholics.025 days = 90 random = 15 }
	}
}

support_emperor_effect = {
	if = {
		limit = {
			OR = {
				AND = {
					hre_religion = protestant
					religion = protestant
				}
				AND = {
					hre_religion = catholic
					religion = catholic
				}
				AND = {
					hre_religion = reformed
					religion = reformed
				}
			}
		}
		if = {
			limit = { piety = 0.60 }
			add_prestige = 8
			add_legitimacy = 4
		}
		else_if = {
			limit = { piety = 0.20 }
			add_prestige = 6
			add_legitimacy = 3
		}
		else_if = {
			limit = { piety = -0.20 }
			add_prestige = 4
			add_legitimacy = 2
		}
		else_if = {
			limit = { piety = -0.60 }
			add_prestige = 2
			add_legitimacy = 1
		}
	}
	add_yearly_manpower = -0.10
	if = {
		limit = { monthly_income = 250 }
		add_treasury = -500
	}
		if = {
			limit = { max_manpower = 128 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 12.8 }
			}
		}
		else_if = {
			limit = { max_manpower = 64 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 6.4 }
			}
		}
		else_if = {
			limit = { max_manpower = 32 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 3.2 }
			}
		}
		else_if = {
			limit = { max_manpower = 16 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 1.6 }
			}
		}
		else_if = {
			limit = { max_manpower = 8 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 0.8 }
			}
		}
		else_if = {
			limit = { max_manpower = 4 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 0.4 }
			}
		}
		else_if = {
			limit = { max_manpower = 2 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 0.2 }
			}
		}
		else = {
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 0.1 }
			}
		}
		if = {
			limit = { NOT = { monthly_income = 5 } }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 4 }
			}
		}
	else_if = {
		limit = { monthly_income = 2 }
		add_years_of_income = -0.16
	}
	else = {
		add_treasury = -4
	}
	hidden_effect = {
		if = {
			limit = {
				monthly_income = 5
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 10
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 15
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 20
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 30
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 40
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 50
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 60
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 80
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 100
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 120
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 140
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 160
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 180
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 200
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 225
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 50 }
			}
		}
		if = {
			limit = {
				monthly_income = 250
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 50 }
			}
		}
	}
	random_country = {
		limit = { is_emperor = yes }
		country_event = { id = DG_Catholics.025 days = 90 random = 15 }
	}
}
