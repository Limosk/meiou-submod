namespace = flavor_mal

province_event = {
	id = flavor_mal.2
	title = flavor_mal.2.t
	desc = flavor_mal.2.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	fire_only_once = yes
	mean_time_to_happen = { 
		years = 1
	}
	trigger = {
		province_id = 1121
		NOT = {
			exists = FLO
		}
		is_year = 1470
	}
	option = {
		name = flavor_mal.2.a
		every_province = {
			limit = {
				culture = fulani
			}
			add_province_modifier = {
				name = "mal_fulani_migration"
				duration = 3650
			}
			add_unrest = 10
		}
		FLO = {
			define_ruler = {
				name = "Koli Tengella"
				dynasty = "Denianke"
				MIL = 4
				claim = 100
			}
			if = {
				limit = {
					has_dlc = "Rights of Man"
				}
				hidden_effect = {
					add_ruler_personality = conqueror_personality
				}
			}
			capital_scope = {
				cavalry = FLO
			}
			every_owned_province = {
				infantry = FLO
			}
			hidden_effect = {
				set_country_flag = in_good_shape
			}
		}
	}
}
country_event = {
	id = flavor_mal.3
	title = flavor_mal.2.t
	desc = flavor_mal.2.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	is_triggered_only = yes
	trigger = {
		NOT = {
			owns = 1121
		}
	}
	option = {
		name = flavor_nub.2.a
		tooltip = {
			every_province = {
				limit = {
					culture = fulani
				}
				add_core = FLO
			}
		}
	}
}
country_event = {
	id = flavor_mal.4
	title = flavor_mal.4.t
	desc = flavor_mal.4.d
	picture = ECONOMY_eventPicture
	is_triggered_only = yes
	fire_only_once = yes
	trigger = {
		tag = MAL
		exists = POR
		is_year = 1455
		any_owned_province = {
			AND = {
				superregion = west_africa_superregion
				OR = {
					region = senegambia_region
					region = guinea_region
					region = lower_volta_region
					region = manding_region
					region = niger_bend_region
				}
			}
			has_discovered = POR
		}
	}
	option = {
		name = flavor_mal.4.a
		add_country_modifier = {
			name = mal_portuguese_traders
			duration = -1
		}
	}
}
country_event = {
	id = flavor_mal.5
	title = flavor_mal.5.t
	desc = flavor_mal.5.d
	picture = ACCUSATION_eventPicture
	is_triggered_only = yes
	fire_only_once = yes
	trigger = {
		tag = MAL
		exists = POR
		is_year = 1465
		has_country_modifier = mal_portuguese_traders
		any_owned_province = {
			AND = {
				superregion = west_africa_superregion
				OR = {
					region = senegambia_region
					region = guinea_region
					region = lower_volta_region
					region = manding_region
					region = niger_bend_region
				}
			}
		}
	}
	option = {
		name = flavor_mal.5.a
		add_country_modifier = {
			name = mal_wangaras_upset
			duration = -1
		}
		remove_country_modifier = mal_portuguese_traders
		POR = {
			add_opinion = {
				who = MAL
				modifier = trade_conflict
			}
		}
	}
	option = {
		name = flavor_mal.5.b
		Stab_Add50Percent = yes
		every_owned_province = {
			limit = {
				OR = {
					AND = {
						superregion = west_africa_superregion
						OR = {
							region = senegambia_region
							region = guinea_region
							region = lower_volta_region
							region = manding_region
							region = niger_bend_region
						}
					}
					province_id = 1111
					province_id = 2770
					province_id = 1121
				}
			}
			add_province_modifier = {
				name = "mal_portuguese_meddling"
				duration = 3650
			}
		}
	}
}
country_event = {
	id = flavor_mal.6
	title = flavor_mal.6.t
	desc = flavor_mal.6.d
	picture = RELIGIOUS_TURMOIL_eventPicture
	fire_only_once = yes
	trigger = {
		tag = MAL
		religion_group = muslim
	}
	mean_time_to_happen = {
		years = 37
	}
	option = {
		name = flavor_mal.6.a
		add_country_modifier = {
			name = mal_islamisation_of_the_aristocracy
			duration = -1
		}
	}
	option = {
		name = flavor_mal.6.b
		Stab_Add50Percent = yes
	}
}
country_event = {
	id = flavor_mal.7
	title = flavor_mal.7.t
	desc = flavor_mal.7.d
	picture = OVEREXTENSION_eventPicture
	fire_only_once = yes
	mean_time_to_happen = {
		years = 1
	}
	trigger = {
		tag = MAL
		is_year = 1480
		NOT = {
			is_year = 1550
		}
		OR = {
			is_neighbor_of = FLO
			is_neighbor_of = TAK
			any_owned_province = {
				has_province_modifier = mal_fulani_migration
			}
		}
	}
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					is_capital = no
					any_neighbor_province = {
						is_capital = no
					}
				}
				set_province_flag = mali_roads_unsafe
			}
			random_owned_province = {
				limit = {
					is_capital = no
					any_neighbor_province = {
						is_capital = no
					}
					NOT = {
						has_province_flag = mali_roads_unsafe
					}
				}
				set_province_flag = mali_roads_unsafe
			}
			random_owned_province = {
				limit = {
					is_capital = no
					any_neighbor_province = {
						is_capital = no
					}
					NOT = {
						has_province_flag = mali_roads_unsafe
					}
				}
				set_province_flag = mali_roads_unsafe
			}
			random_owned_province = {
				limit = {
					is_capital = no
					any_neighbor_province = {
						is_capital = no
					}
					NOT = {
						has_province_flag = mali_roads_unsafe
					}
				}
				set_province_flag = mali_roads_unsafe
			}
			random_owned_province = {
				limit = {
					is_capital = no
					any_neighbor_province = {
						is_capital = no
					}
					NOT = {
						has_province_flag = mali_roads_unsafe
					}
				}
				set_province_flag = mali_roads_unsafe
			}
		}
	}
	option = {
		name = flavor_mal.7.a
		ai_chance = {
			factor = 40
		}
		every_owned_province = {
			limit = {
				has_province_flag = mali_roads_unsafe
			}
			add_local_autonomy = 60
			add_province_modifier = {
				name = "mal_unsafe_roads"
				duration = 365
			}
			custom_tooltip = peasants_organizing_tt
			clr_province_flag = mali_roads_unsafe
		}
	}
	option = {
		name = flavor_mal.7.b
		ai_chance = {
			factor = 20
		}
		add_adm_power = -100
		every_owned_province = {
			limit = {
				has_province_flag = mali_roads_unsafe
			}
			add_province_modifier = {
				name = "mal_unsafe_roads"
				duration = 915
			}
			custom_tooltip = peasants_organizing_tt
			clr_province_flag = mali_roads_unsafe
		}
	}
	option = {
		name = flavor_mal.7.c
		ai_chance = {
			factor = 40
		}
		every_owned_province = {
			limit = {
				has_province_flag = mali_roads_unsafe
			}
			add_province_modifier = {
				name = "mal_unsafe_roads"
				duration = 3650
			}
			custom_tooltip = peasants_organizing_tt
			clr_province_flag = mali_roads_unsafe
		}
	}
}
country_event = {
	id = flavor_mal.8
	title = flavor_mal.8.t
	desc = flavor_mal.8.d
	picture = CIVIL_WAR_eventPicture
	fire_only_once = yes
	trigger = {
		tag = MAL
		NOT = {
			exists = KAA
		}
		is_year = 1475
		religion_group = muslim
		any_owned_province = {
			is_core = KAA
			is_capital = no
		}
	}
	mean_time_to_happen = {
		years = 37
		modifier = {
			factor = 0.7
			any_owned_province = {
				is_core = KAA
				has_province_modifier = mal_unsafe_roads
			}
		}
		modifier = {
			factor = 0.7
			any_owned_province = {
				is_core = KAA
				has_province_modifier = mal_portuguese_meddling
			}
		}
		modifier = {
			factor = 0.7
			has_country_modifier = mal_islamisation_of_the_aristocracy
		}
	}
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						exists = KAA
					}
				}
				KAA = { clr_country_flag = POP_Init }
			}
		}
	}
	option = {
		name = flavor_mal.8.a
		ai_chance = {
			factor = 90
		}
		every_owned_province = {
			limit = {
				is_core = KAA
			}
			add_province_modifier = {
				name = "nationalists_organizing"
				duration = 1825
			}
			custom_tooltip = nationalists_organizing_tt
			add_unrest = 7
		}
	}
	option = {
		name = flavor_mal.8.b
		ai_chance = {
			factor = 10
		}
		release = KAA
		hidden_effect = {
			KAA = {
				Pol_ChangeGovMonarchy = { Succession = 1 Assembly = 2 } 
				add_government_reform = Pol_Nobility2
				if = { 
					limit = {
						NOT = {
							has_country_flag = POP_Init
						}
					}
					country_event = {
						id = Init.1
					}
				}
			}
		}
		KAA = {
			define_ruler = {
				name = "Sama Koli"
				dynasty = "Jeenung"
			}
		}
	}
}
